<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="Content-Language" content="zh-TW">
        <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
        <meta name="keywords" content=""/>
        <meta name="description" content="">
        <meta property="og:image" itemprop="image" content="" />
        <meta property="og:title" content="" />
        <meta property="og:description" content="" />
        <meta property="og:url" content="" />
        <meta property="og:type" content="website" />
        <meta property="og:site_name" content="金門酒廠" />
        
        <title>填寫會員資料 | 金門酒廠</title>
        
        
        
        <link rel="stylesheet" href="assets/css/bootstrap.css">
        <link rel="stylesheet" href="assets/css/custom.css">
        <link rel="icon" type="image/x-icon" href="assets/img/favicon.ico">
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    </head>
    <body id="top">
        <header class="" id="header">
            <div class="container-fluid pt-60 pb-40">
                <div class="text-center">
                    <img src="assets/img/logo.png" height="75" alt="金門酒廠">
                </div>
            </div>
        </header>

        <main class="pb-100">
            <div class="container-fluid">
                <div class="d-grid gap-12 mb-20">
                    <div class="mb-0 h3 text-center">
                        填寫會員資料
                    </div>
                </div>
                <form class="validate-form" id="googleForm">
                    <div class="d-grid gap-20 mb-60 mx-20">
                        <div class="row align-items-center g-8">
                            <label class="col-3 col-form-label lh-1" for="name">
                                *姓名<br>name
                            </label>
                            <div class="col-9">
                                <input type="text" class="form-control" id="name" placeholder="請輸入姓名" required>
                            </div>
                        </div>

                        <div class="row align-items-center g-8">
                            <label for="title" class="col-3 col-form-label lh-1">
                                稱謂*<br><span style="letter-spacing: 0.05rem;">title</span>
                            </label>
                            <div class="col-9">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="title" id="male" value="先生" checked>
                                    <label class="form-check-label" for="male">先生</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="title" id="female" value="女士">
                                    <label class="form-check-label" for="female">女士</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="title" id="miss" value="小姐">
                                    <label class="form-check-label" for="miss">小姐</label>
                                </div>
                            </div>
                        </div>

                        <div class="row align-items-center g-8">
                            <label class="col-3 col-form-label lh-1" for="nation">
                                國籍*<br>nation
                            </label>
                            <div class="col-9">
                                <input class="form-control" id="nation" type="text" placeholder="請輸入國籍" required>
                            </div>
                        </div>

                        <div class="row align-items-center g-8">
                            <label class="col-3 col-form-label lh-1" for="phone">
                                手機*<br>phone
                            </label>
                            <div class="col-9">
                                <input class="form-control" id="phone" name="phone" type="tel" placeholder="請輸入手機號碼" minlength="10" maxlength="10" pattern="09\d{2}-\d{6}" required>
                            </div>
                        </div>

                        <div class="row align-items-center g-8">
                            <label class="col-12 col-form-label lh-1" for="email">
                                電子郵件 e-mail*
                            </label>
                            <div class="col-12">
                                <input class="form-control" id="email" type="email" placeholder="請輸入電子郵件" required>
                                <span class="fs-small text-danger" id="emailError"></span>
                            </div>
                        </div>

                        <div class="row align-items-center g-8">
                            <label class="col-12 col-form-label lh-1" for="address">
                                聯絡地址 address
                            </label>
                            <div class="col-12">
                                <input class="form-control" id="address" type="text" placeholder="請輸入聯絡地址">
                            </div>
                        </div>

                        <div class="row align-items-center g-8">
                            <label class="col-12 col-form-label lh-1" for="idnumber">
                                身分證字號/居留證號碼 ID number
                            </label>
                            <div class="col-12">
                                <input class="form-control" id="idnumber" type="text" placeholder="請輸入身分證字號/居留證號碼">
                            </div>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" name="agree" id="agree" value="同意" required>
                            <label class="form-check-label" for="agree">
                                提醒您：送出資料後即代表您同意將此資料提供金門酒廠進行行銷處理與使用。<br>
                                <div class="text-justify">
                                    Reminder: By submitting the data, you are giving your consent for this information to be provided to Kinmen Kaoliang Liquor for marketing processing and usage.
                                </div>
                            </label>
                        </div>
                    </div>
                    <div class="d-flex gap-12 col-6   mx-auto">
                        
                            <div class="d-grid col">
                                <button class="btn btn-lg btn-outline-secondary " id="submit" type="button" >
                                    送出
                                </button>
                            </div>
                        
                    </div>
                </form>
            </div>
        </main>
        <footer class="fixed-bottom" id="footer">
            <div class="container-fluid bg-black py-20">
                <div class="h4 fw-normal text-center text-secondary mb-0">
                    <span>酒後不開車</span>
                    <span>安全有保障</span>
                </div>
            </div>
        </footer>
        <script>
            $(function() {
                $('#submit').on('click', function() {                

                    var title = function() {
                    var v;
                    $('[name="title"]').each(function() {
                        if($(this).prop('checked') === true) v = $(this).val();
                    });
                    return v;
                    };
                    
                    var agree = function() {
                    var v2;
                    $('[name="agree"]').each(function() {
                        if($(this).prop('checked') === true) v2 = $(this).val();
                    });
                    return v2;
                    };
                    var name = $('#name').val();
                    var nation = $('#nation').val();
                    var phone = $('#phone').val();
                    var email = $('#email').val();
                    var address = $('#address').val();
                    var idnumber = $('#idnumber').val();

                    // post
                    var data = {
                    'entry.1147564651': name,
                    'entry.260124935': title(),
                    'entry.436519124': nation,
                    'entry.321157543': phone,
                    'entry.1564237122': email,
                    'entry.697882627': address,
                    'entry.1073581126': idnumber,
                    'entry.237283503': agree()
                    };

                    var isValid = true;

                    //必填欄位檢查
                    $('#googleForm [required]').each(function() {
                        const input = $(this);
                        const label = $('label[for="' + input.attr('id') + '"]');
                        if (input.is(':checkbox') && !input.is(':checked')) {
                            input.addClass('input-error');
                            label.addClass('text-danger');
                        } else if (input.val().trim() === '') {
                            input.addClass('input-error');
                            label.addClass('text-danger');
                        } else {
                            input.removeClass('input-error');
                            label.removeClass('text-danger');
                        }
                    });

                    //Email格式檢查
                    var emailInput = $('#email');
                    var email = emailInput.val().trim();
                    if (email !== '') {
                        var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                        if (!emailPattern.test(email)) {
                            emailInput.addClass('input-error');
                            $('#emailError').text('請輸入正確的Email格式');
                            isValid = false;
                        } else {
                            emailInput.removeClass('input-error');
                            $('#emailError').text('');
                        }
                    }
                    
                    if ($('#name').val() && $('#nation').val() && $('#phone').val() && $('#email').val() && $('#agree').prop('checked') === true) {
                        $.ajax({
                            type: 'POST',
                            url: 'https://docs.google.com/forms/u/1/d/e/1FAIpQLSf2kqwHSdvefzCYOyz4FISR63aZyDHGI0HDyEgO8xaOwALI-w/formResponse',
                            data: data,
                            contentType: 'application/json',
                            dataType: 'jsonp',
                            complete: function() {
                                if (isValid) {
                                    // alert('資料已送出！');
                                    window.location.replace("success.html");
                                }
                            }
                        });
                    }
                });
            });
            
            $(document).ready(function() {
                $('#googleForm [required]').on('input', function() {
                    var allCompleted = true;
                    $('#googleForm [required]').each(function() {
                        var input = $(this);
                        if (input.val().trim() === '') {
                            allCompleted = false;
                            return false;
                        }
                    });
                    if (allCompleted) {
                        $('#submit').addClass('btn-outline-dark');
                    } else {
                        $('#submit').removeClass('btn-outline-dark');
                    }
                });
            });
        </script>
    </body>
</html>